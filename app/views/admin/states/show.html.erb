<% title @state.name %>

<h1 class="page-title"><i class="icon-globe"></i>&nbsp;<%= @state.name %>&nbsp;<span class="muted"><%= @state.country_alpha2 %></span></h1>

<div class="box">
	<%= alphabet_filter @cities%>
	<table class="table table-striped table-bordered">
		<thead>
		  <tr>
		  	<th class="thumb"></th>
		    <th><%= sort_column("cities.name", "City") %></th>
		    <th>Locations</th>
		    <th>Actions</th>
		  </tr>
		</thead>
		<tfoot>
	  	<tr>
	    	<th colspan="5" class="filter-row">
	    		<div class="per-page pull-left">
	    			<%= per_page_select %>
	    		</div>

	    	</th>
	    </tr>
	  </tfoot>
	  

	<% @cities.each do |city| %>

	  <tr>
	  	<td class="thumb"><%=
	  		table_thumb(city)
	  		%>
	  	</td>
	    <td><%= city.name %></td>
	    <td class="td-count"><div class="loc-count"><%= city.locations.count %></div></td>
	     <td class="td-actions">
			  <div class="btn-group">
			  	<%= link_to raw('<i class="icon-eye-open"></i>'), admin_state_city_path(@state, city), :class => 'btn btn-small' if can? :read, city %>
			  	<%= link_to raw('<i class="icon-edit"></i>'), edit_admin_state_city_path(@state, city), :class => 'btn btn-small btn-warning' if can? :edit, city %>
			  	<%= link_to raw('<i class="icon-trash icon-white"></i>'), admin_state_city_path(@state, city), method: :delete, data: { confirm: 'Are you sure?' }, :class => 'btn btn-small btn-danger' if can?(:delete, city) && !city.locations.any? %>
			  </div>
	      </td>
	  </tr>
	<% end %>
	</table>
	
	<%= paginate @cities%>
</div>